namespace = auto_council

auto_council.0001 = {
	type = character_event
	title = auto_council_0001_t
	desc = auto_council_0001_desc
	theme = faith

	left_portrait = {
		character = root
		animation = personality_rational
	} 
	right_portrait = {
		character = cp:councillor_court_chaplain
		animation = personality_zealous
	}
		
	option = { # Start the Conversion
		name = auto_council_0001_a
		trigger = {
			any_realm_county = {
				NOT = {
					faith = root.faith
				}
			}
		}
		
		every_realm_county = {
			if = {
				limit = { NOT = { faith = root.faith }}
				add_to_list = heathens
			}
		}
		
		send_interface_message = {
			type = event_generic_good
			right_icon = scope:court_chaplain
			title = auto_council_0001_mes1
		}

		trigger_event = auto_council.0002
	}
	
	option = { # Cancel
		name = auto_council_0001_b
		add_piety = 50	
	}
}

auto_council.0002 = {
	hidden = yes
	type = character_event

	immediate = {
		if = {
			limit = {
				any_in_list = {
					list = heathens
				}			
			}
			random_in_list = {
				list = heathens
				save_scope_as = selected_county
				remove_from_list = heathens
			}

			if = {
				limit = { exist = selected_county }
				cp:councillor_court_chaplain = {				
					set_council_task = {
						task_type = task_conversion
						target = scope:selected_county
					}				
				}
				set_variable = {
					name = heathens_count
					value = 0
				}
	
				every_in_list = {
					list = heathens
					change_variable = {
						name = heathens_count
						add = 1
					}
				}
				send_interface_message = {
					type = event_generic_good
					right_icon = scope:court_chaplain
					title = auto_council_0002_mes1
					desc = auto_council_0002_mes1_body
				}
				remove_variable = heathens_count
			}
			else = { add_piety = 50}
		}
	}
}
